{% extends "usersite/customerindex.html" %}
{% load my_filter %}


{% block page %}
<style>
 .invoice-container {
    max-width: 800px;
    margin: auto;
    
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
} 
.header1 {
    display: flex;
    justify-content: space-between;
    align-items: center;
    
}
.header1 img {
    width: 50px;
}
.header1 h1 {
    font-size: 24px;
    color: #2f4f70;
}
.invoice-details {
    margin: 20px 0;
}
.invoice-details p {
    margin: 5px 0;
}
.bill-section {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
    margin-top: 20px;
}
.bill-section div {
    width: 48%;
}
.bill-section div h3 {
    font-size: 18px;
    margin-bottom: 5px;
}
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}
table, th, td {
    border: 1px solid #ddd;
}
th, td {
    padding: 10px;
    text-align: center;
}
th {
    background-color: #f4f4f4;
}
.total-section {
    display: flex;
    justify-content: flex-end;
}
.total-section div {
    width: 200px;
}
.total-section div p {
    margin: 5px 0;
    text-align: right;
}
.total-section div p span {
    display: inline-block;
    width: 100px;
}
.total-section div h2 {
    margin-top: 10px;
    font-size: 24px;
    color: #2f4f70;
    text-align: right;
}

</style>
<!-- <div class="row justify-content-center"> -->
<div class="invoice-container">
    <div class="header1">
        <div>
            <h2>Ecommerce Surface</h2>
            <p>Invoice Number: 1330</p>
            <p>Date: 02/02/2022</p>
        </div>
        <div>
            <h1>INVOICE</h1>
        </div>
    </div>
    <!-- </div> -->
    <div class="bill-section">
        <div>
            <h3 class="fw-bolder">Bill from:</h3>
            <p>Nature E-Commerce</p>
            <p>Azamgarh U.P. , Zip Code : 275101</p>
            <p>+91 8808177980</p>
        </div>
        <div>
            <h3 class="fw-bolder">Bill to:</h3>
            <p>{{address.cname|title}}</p>
            <p>{{address.address|title}} {{address.city|title}} {{address.state|title}}, Zip Code : {{address.postal}}</p>
            <p>+91 {{address.phone}}</p>
        </div>
    </div>

    <table>
        <tr>
            <th>Item</th>
            <th>Quantity</th>
            <th>Rate</th>
            <th>Tax</th>
            <th>Amount</th>
        </tr>
        {% for item in pcart %}
        <tr>
            <td>{{ item|CheckName|title }}</td>
            <td>{{ item|CheckQty:request.session.pcart }}</td>
            <td>{{ item|CheckPrice }}</td>
            <td>0.00</td>
            <td>{{ item|Total:request.session.pcart }}</td>
        </tr>
        {% endfor %}
        
    </table>

    <p><strong>Terms & Conditions:</strong></p>

    <div class="total-section">
        <div>
            <p><span>Subtotal:</span> {{ pcart|Subtotal:request.session.pcart }}</p>
            <p><span>Discount:</span> {{ pcart|Discount:request.session.pcart }}</p>
            <p><span>Tax:</span> ₹0.00</p>
            <p><span>Paid:</span> ₹0.00</p>
            <h2>Total: {{ pcart|TotalAmount:request.session.pcart }}</h2>
        </div>
    </div>
</div>
<!-- </div> -->
{% endblock page %}

{% block content %}
<div class="pagetitle">
    <nav class="d-flex justify-content-lg-between" style="--bs-breadcrumb-divider: '•';">
      <div>
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="/profile/">
            <i class="bi bi-house-door"></i>
          </a>
        </li>
        <li class="breadcrumb-item active">Profile</li>
        <li class="breadcrumb-item active">View cart</li>
        <li class="breadcrumb-item active">Check-out</li>
        <li class="breadcrumb-item active">Invoice</li>
      </ol>
      </div>
      <div>
      <h4 style="margin-right: 2vw;" class="breadcrumb">
        <form action="" method="post">
            {% csrf_token %}
            <button id="download" class="border-0"></a>Download</button>
        </form>
      </h4>
      </div>
    </nav>
  </div><!-- End Page Title -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script
    src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script>
    
    $(document).on('click','#download',function(event){
        event.preventDefault();
        alert("hh")
        $.ajax({
            type: 'POST',
            url: '/profile/viewcart/checkout/invoice/download/',
            data: {
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
            },
            success: function(response) {
                alert(response.message);
            },
            error: function(response) {
                alert("Request Failed !!! " + response.message);
            }
        });
    });
  </script>
{% endblock content %}
